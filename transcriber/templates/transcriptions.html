{% extends 'base.html' %}
{% from 'macros.html' import render_image, render_admin_header %}
{% block title %}{{task.name}}{% endblock %}
{% block content %}

{{ render_admin_header(task.name, task, task.id, 'transcriptions') }}

<div class="row">
    <div class="col-sm-12">
        {% if transcriptions %}
            <h3><strong>{{transcriptions|length - 1}}</strong> images fully transcribed</h3>
            <a href="{{ url_for('views.download_transcriptions', task_id=task.id) }}" class="btn btn-default pull-right"><i class="fa fa-download fa-fw"></i> Download CSV</a>
            <div>
                <i class="fa fa-times fa-fw"></i> Blank &nbsp;&nbsp;&nbsp;
                <i class="fa fa-question fa-fw"></i> Not legible &nbsp;&nbsp;&nbsp;
                <i class="fa fa-exclamation-triangle fa-fw"></i> Looks altered <br>
            </div>
            <table class="table">
                <tr>
                    {% for h in transcriptions[0] %}
                        <th> {{h}} </th>
                    {% endfor %}
                </tr>
                {% for transcription in transcriptions[1:] %}
                    <tr>
                        {% for col in transcription %}
                            <td><small> {{col|safe}} </small></td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </table>
        {% else %}
            <h2>No fully transcribed images yet</h2>
        {% endif %}
    </div>
</div>

{% if images_partly_seen %}
<div class="row">
    <div class="col-sm-12">
        <hr>
        <h3><strong>{{images_partly_seen|length}}</strong> images partially transcribed</h3>
        <strong>image_id list</strong><br>
        {% for image in images_partly_seen %}
            <div class="unseen-image small"><a href="{{image.fetch_url}}" target="_blank"> {{image.id}} </a></div>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if images_unseen %}
<div class="row">
    <div class="col-sm-12">
        <hr>
        <h3><strong>{{images_unseen|length}}</strong> images without any transcriptions yet</h3>
        <strong>image_id list</strong><br>
        {% for image in images_unseen %}
            <div class="unseen-image small"><a href="{{image.fetch_url}}" target="_blank"> {{image.id}} </a></div>
        {% endfor %}
    </div>
</div>
{% endif %}


{% endblock %}
{% block extra_javascript %}

    <script type="text/javascript">
        $(document).ready(function(){
            $('tr td:nth-child(1)').css('background-color', '#eee');
            $('tr td:nth-child(2)').css('background-color', '#eee');
            $('tr td:nth-child(3)').css('background-color', '#eee');
            $('tr td:nth-child(4)').css('background-color', '#eee');
            $('td >> .fa-question').parent().parent().css('background-color','#fcebca');
            $('td >> .fa-times').parent().parent().css('background-color','#f9da9a');
            $('td >> .fa-exclamation-triangle').parent().parent().css('background-color','#fab0a7');
        })

    </script>
{% endblock %}
