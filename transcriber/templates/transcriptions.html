{% extends 'base.html' %}
{% from 'macros.html' import render_image, render_admin_header %}
{% block title %}{{task.name}}{% endblock %}
{% block content %}

{{ render_admin_header(task.name, task, task.id, 'transcriptions') }}

<div class="row">
    <div class="col-sm-12">
        {% if transcriptions %}
            <a href="{{ url_for('views.download_transcriptions', task_id=task.id) }}" class="btn btn-default pull-right"><i class="fa fa-download fa-fw"></i> Download CSV</a>
            <div>
                <i class="fa fa-times fa-fw"></i> Blank <br>
                <i class="fa fa-question fa-fw"></i> Not legible <br>
                <i class="fa fa-exclamation-triangle fa-fw"></i> Looks altered <br>
            </div>
            <table class="table">
                <tr>
                    {% for h in transcriptions[0] %}
                        <th> {{h}} </th>
                    {% endfor %}
                </tr>
                {% for transcription in transcriptions[1:] %}
                    <tr>
                        {% for col in transcription %}
                            <td><small> {{col|safe}} </small></td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </table>
        {% else %}
            <h2>No transcriptions yet</h2>
        {% endif %}
    </div>
</div>

{% if images_unseen %}
<div class="row">
    <div class="col-sm-12">
        <hr>
        <h3><strong>{{images_unseen|length}}</strong> images without any transcriptions yet</h3>
        <strong>image_id</strong>
        {% for image in images_unseen %}
            <br><a href="{{image.fetch_url}}" target="blank"> {{image.id}} </a>
        {% endfor %}
    </div>
</div>
{% endif %}


{% endblock %}
{% block extra_javascript %}

    <script type="text/javascript">
        $(document).ready(function(){
            $('tr td:nth-child(1)').css('background-color', '#eee');
            $('tr td:nth-child(2)').css('background-color', '#eee');
            $('tr td:nth-child(3)').css('background-color', '#eee');
            $('tr td:nth-child(4)').css('background-color', '#eee');
            $('td >> .fa-question').parent().parent().css('background-color','#fcebca');
            $('td >> .fa-times').parent().parent().css('background-color','#f9da9a');
            $('td >> .fa-exclamation-triangle').parent().parent().css('background-color','#fab0a7');
        })

    </script>
{% endblock %}
